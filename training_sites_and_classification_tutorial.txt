Run Spatial Features (MapPy)

1. > cd C:\Program Files (x86)\Python27\ArcGIS10.3\Lib\site-packages\mappy\features
2. > feas.py -i C:\Users\wb486933\Secondary_Cities\IMAGERY_4band\orthorectified\rubavu_img_spot6_pms_201308250754469_sen_1337646101_r1c1.img -o C:\Users\wb486933\Secondary_Cities\Mappy_Classification\rubavu -blk 8 -scs 16 -tr ndvi -bd 1

Create Virtual Stack of Features (MapPy)

1. Text file (Includes dmp, fourier, gabor, hog, lbpm, mean, ndvi, pantex = 108 layers): C:\Users\wb486933\Ten_Cities\Mappy_Classification\nairobi_new_file_list.txt
2. > import subprocess
3. > subprocess.call(["gdalbuildvrt", "-separate", "-input_file_list", "C:\\Users\\wb486933\\Ten_Cities\\Mappy_Classification\\kigali_new\\kigali_new_file_list.txt", "C:\\Users\\wb486933\\Ten_Cities\\Mappy_Classification\\kigali_new\\kigali_new_stack01.vrt"])

Train the VRT (ArcGIS)

4. Create training polygons: nairobi_new_training_cutline01_class01.shp
	a. Polygon, projection in UTM zone
	b. Classes: 
		i. 	1: residential regular (formal)
		ii. 	2: residential irregular (informal)
		iii. 	3: commercial/industrial
		iv. 	4: veg
		v. 	5: barren
		vi. 	6: water
5. Dissolve each training class into 1 polygon: 
	a. C:\Users\wb486933\Ten_Cities\Training\Nairobi_new\nairobi_new_training_cutline01_class01_dissolve.shp
6. Create random points, 500 per class
	a. C:\Users\wb486933\Ten_Cities\Training\Nairobi_new\nairobi_new_training_cutline01_class01_point500.shp
7. Open attribute tables 
	a. Column CID > field calculator > assign their proper classes
8. Merge all points into one class: 
	a. C:\Users\wb486933\Ten_Cities\Training\Nairobi_new\nairobi_new_training_cutline01_points_merge.shp


Sample training polygons (MapPy)

9. > cd C:\Program Files (x86)\Python27\ArcGIS10.3\Lib\site-packages\mappy\sample
10. > sampleRst.py -p C:\Users\wb486933\Ten_Cities\Training\dakar_new\cutline02\dakar_new_training_cutline02_points_merge.shp -c cid -i C:\Users\wb486933\Ten_Cities\Mappy_Classification\dakar_new\dakar_new_stack01.vrt -o C:\Users\wb486933\Ten_Cities\Mappy_Classification\dakar_new
11. Parameters: 
	a. -p = Points shapefile to sample 
	b. -c = attribute column with classes
	c. -i = virtual stack to sample 
	d. -o = output directory

Classify the image (MapPy)

12. > cd C:\Program Files (x86)\Python27\ArcGIS10.3\Lib\site-packages\mappy\classifiers
13. > classification.py -s C:\Users\wb486933\Ten_Cities\Mappy_Classification\dakar_new\dakar_new_training_cutline02_points_merge_01.txt -cli classifier:RF,trees:100 -i C:\Users\wb486933\Ten_Cities\Mappy_Classification\dakar_new\dakar_new_stack01.vrt -o C:\Users\wb486933\Ten_Cities\Mappy_Classification\dakar_new\dakar_new_stack01_cutline02_classified01.img
14. Parameters: 
	a. -s = sample info you just created from the points (will be in your output directory you just created)
	b. -cli = what kind of classification you want to do.  Random forests with 100 trees
	c. -i = virtual stack to classify
	d. -o = output classified image with extension 

Clip to cutline (if have mosaicked VRT) (ArcGIS)

1. Raster clip
2. Output: C:\Users\wb486933\Ten_Cities\Mappy_Classification\Nairobi_new\nairobi_new_stack01_cutline01_classified01_clipped.img

PROJECT the classified image to UTM ZONE if not already in correct zone (ArcGIS)

Merge cutlines together (if you have a mosaicked VRT) (ArcGIS)

3. Mosaic to new raster
4. Cell size: whatever the mappy classification outputs. 
	a. For example, if you have 0.5m imagery, and use block size of 32, your cell size is 0.5x32 = 16m
5. Output: C:\Users\wb486933\Ten_Cities\Mappy_Classification\Nairobi_new\nairobi_new_mosaic_classified.img

Smooth the Classified image (gets rid of anomalous pixels) (Erdas)

	1. Erdas > Raster > Thematic > Neighborhood 
	2. 5x5 Majority Filter: C:\Users\wb486933\Secondary_Cities\Mappy_Classification\muhanga\muhanga_classified_smooth5.img

Make raster a thematic layer (Erdas)

1. Erdas > Subset and Chip > thematic
	a. C:\Users\wb486933\Ten_Cities\Mappy_Classification\Nairobi_new\nairobi_new_mosaic_classified_smooth5_thematic.img
